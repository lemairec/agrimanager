{% extends 'base_agri.html.twig' %}



{% form_theme form _self %}

{% block form_row %}
<div class="form-group row">
    <div class="col-sm-2">
        {{ form_label(form) }}
    </div>

    <div class="col-sm-10">
        {{ form_widget(form) }}
    </div>
    {{ form_errors(form) }}
</div>
{% endblock form_row %}


{% block body %}

<div class="container bs-docs-container">
<div class="well">
    {{ form_start(form) }}
    {{ form_row(form.date, {'attr': {'class': 'form-control js-datepicker'}}) }}
    {{ form_row(form.type, {'attr': {'class': 'form-control'}}) }}
    {{ form_row(form.comment, {'attr': {'class': 'form-control'}}) }}
    {{ form_row(form.save) }}
    <input type="submit" class="btn btn-primary" value="Sauvegarder" />
    {{ form_end(form) }}
</div>

<div class="card">
    <div class="card-header">
        Parcelles
        <button type="button" class="btn btn-primary" onclick="window.location.href='/intervention/{{intervention.id}}/parcelle/0'">{{'Add' | trans}}</button>
    </div>
    <table class="table">
        <tr>
            <th>Id</th>
            <th>{{'Name' | trans}}</th>
            <th>Surface</th>
        </tr>
        {% for it in intervention.parcelles %}
        <tr>
            <td><a href="/intervention/{{intervention.id}}/parcelle/{{it.id}}">{{it.id}}</a></td>
            <td>{{it.parcelle.completeName}}</td>
            <td>{{it.parcelle.surface}}</td>
        </tr>
        {% endfor %}
        <tr>
            <td>TOTAL</td>
            <td></td>
            <td>{{intervention.surface}}</td>
        </tr>
    </table>
</div>
<div class="card">
    <div class="card-header">
        Produits
        <button type="button" class="btn btn-primary" onclick="window.location.href='/intervention/{{intervention.id}}/produit/0'">{{'Add' | trans}}</button>
    </div>
    <table class="table">
        <tr>
            <th>Amm</th>
            <th>{{'Name' | trans}}</th>
            <th>Qty</th>
            <th></th>
        </tr>
        {% for it in intervention.produits %}
        <tr>
            <td><a href="/intervention/{{intervention.id}}/produit/{{it.id}}">{{it.id}}</a></td>
            <td>{{it.name}}</td>
            <td>{{it.qty}}</td>
            <td><a href="/intervention/{{intervention.id}}/produit/{{it.id}}/delete">d</td>
        </tr>
        {% endfor %}
    </table>
</div>
<div class="card">
    <div class="card-header">
        Materiel
        <button type="button" class="btn btn-primary" onclick="window.location.href='/intervention/{{intervention.id}}/materiel/0'">{{'Add' | trans}}</button>
    </div>
    <table class="table">
        <tr>
            <th>{{'Name' | trans}}</th>
        </tr>
        {% for it in intervention.materiels %}
        <tr>
            <td><a href="/intervention/{{intervention.id}}/produit/{{it.id}}">{{it.materiel.name}}</a></td>
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}


{% block javascripts %}
<script>
$( function() {
    $('#App_intervention_type').on('change',function(e){
        $.post('/intervention/{{intervention.id}}', $('form[name=App_intervention]').serialize())
    });
    $('#App_intervention_comment').on('change',function(e){
        $.post('/intervention/{{intervention.id}}', $('form[name=App_intervention]').serialize())
    });
    $('#App_intervention_date').on('change',function(e){
        $.post('/intervention/{{intervention.id}}', $('form[name=App_intervention]').serialize())
    });
} );
</script>
{% endblock %}
