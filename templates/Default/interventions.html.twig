{% extends 'base_agri.html.twig' %}

{% block body %}


<div class="panel panel-default", style="width:100%">
    <div class="panel-heading">
        Interventions
        <button type="button" class="btn btn-primary" onclick="window.location.href='{{ url("intervention", {'intervention_id': 0}) }}'">ADD</button>
    </div>
</div>

{% for intervention in interventions %}
<div class="panel panel-default", style="width:100%">
    <table class="table">
    <tr bgcolor='{{ intervention.getColor() }}', style="filter:brightness(0.95)">
        <td class="col-2"><a href="{{ url("intervention", {'intervention_id': intervention.id}) }}">{{intervention.get_date()}}</td>
        <td><b>{{intervention.type}}
            {% if intervention.name %}
                - {{ intervention.name }}
            {% endif %}
            </b>
        </td>
        <td class="text-right col-2"><b>{{ intervention.surface | showHa }}</b></td>
        <td class="text-right col-2"><a href="/intervention/{{intervention.id}}/delete">Delete</td>
    </tr>

    {% for it in intervention.parcelles %}
    <tr  bgcolor='{{ it.parcelle.cultureColor}}'>
        <td>{{it.parcelle.culture}}</td>
        <td>{{it.parcelle.completeName}}</td>
        <td class="text-right">{{ it.parcelle.surface | showHa }}</td>
        <td></td>
    </tr>
    {% endfor %}
    {% for it in intervention.produits %}
    <tr bgcolor='{{ intervention.getColor() }}' style="filter:brightness(1.05)">
        <td></td>
        <td>{{it.name}}</td>
        <td class="text-right">{{ it.qty | showUnity(it.produit.unity)}}</td>
        <td class="text-right">{{ it.qtyha | showUnity(it.produit.unity)}}</td>
    </tr>
    {% endfor %}
    {% if intervention.comment %}
    <tr bgcolor='{{ intervention.getColor() }}' style="filter:brightness(1.05)">

        <td colspan="4">
            {{ intervention.comment }}
        </td>
    </tr>
    {% endif %}
    </table>
</div>
{% endfor %}

{% endblock %}
