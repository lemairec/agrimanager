<?php

namespace AgriBundle\Repository;

/**
 * ProduitRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ProduitRepository extends \Doctrine\ORM\EntityRepository
{
    function save($produit){
        $produit_count = $this->createQueryBuilder('p')
            ->select('COUNT(p)')
            ->where('p.name = :name and p.amm = :amm')
            ->setParameter('name', $produit->name)
            ->setParameter('amm', $produit->amm)
            ->getQuery()
            ->getSingleScalarResult();
        echo($produit_count);
        if($produit_count == 0){
            $em = $this->getEntityManager();
            $em->persist($produit);
            $em->flush();
        }
    }
}
